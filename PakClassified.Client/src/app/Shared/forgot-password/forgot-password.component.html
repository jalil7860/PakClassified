<!-- Hero Section -->
<div class="auth-hero">
  <div class="hero-content">
    <h1>Reset Password</h1>
    <p>Recover access to your account</p>
  </div>
</div>

<!-- Main Container -->
<div class="container-sm forgot-password-wrapper">
  <!-- Progress Steps -->
  <div class="progress-container">
    <div class="progress-steps">
      <div class="step-item" [class.active]="currentStep >= 1" [class.completed]="currentStep > 1">
        <div class="step-number">
          <span *ngIf="currentStep <= 1">1</span>
          <i *ngIf="currentStep > 1" class="ri-check-line"></i>
        </div>
        <span class="step-label">Email</span>
      </div>
      
      <div class="step-connector" [class.active]="currentStep > 1"></div>
      
      <div class="step-item" [class.active]="currentStep >= 2" [class.completed]="currentStep > 2">
        <div class="step-number">
          <span *ngIf="currentStep <= 2">2</span>
          <i *ngIf="currentStep > 2" class="ri-check-line"></i>
        </div>
        <span class="step-label">Verify</span>
      </div>
      
      <div class="step-connector" [class.active]="currentStep > 2"></div>
      
      <div class="step-item" [class.active]="currentStep >= 3" [class.completed]="currentStep > 3">
        <div class="step-number">
          <span *ngIf="currentStep <= 3">3</span>
          <i *ngIf="currentStep > 3" class="ri-check-line"></i>
        </div>
        <span class="step-label">Reset</span>
      </div>
      
      <div class="step-connector" [class.active]="currentStep > 3"></div>
      
      <div class="step-item" [class.active]="currentStep >= 4" [class.completed]="currentStep > 4">
        <div class="step-number">
          <span *ngIf="currentStep <= 4">4</span>
          <i *ngIf="currentStep > 4" class="ri-check-line"></i>
        </div>
        <span class="step-label">Done</span>
      </div>
    </div>
  </div>

  <!-- Form Card -->
  <div class="form-card">
    <!-- Step 1: Enter Email -->
    <div *ngIf="currentStep === 1" class="form-step fade-in">
      <div class="step-header">
        <i class="ri-mail-search-line"></i>
        <h3>Find Your Account</h3>
        <p>Enter your email to search for your account</p>
      </div>

      <form [formGroup]="emailForm" (ngSubmit)="onEmailSubmit()" class="auth-form">
        <div class="form-group">
          <label for="email">
            <i class="ri-mail-line"></i>
            Email Address
          </label>
          <input 
            type="email" 
            id="email"
            formControlName="email" 
            class="form-control"
            placeholder="Enter your email"
          >
          <small *ngIf="emailForm.get('email')?.hasError('required') && emailForm.get('email')?.touched" class="error-message">
            <i class="ri-error-warning-line"></i>
            Email is required
          </small>
          <small *ngIf="emailForm.get('email')?.hasError('email') && emailForm.get('email')?.touched" class="error-message">
            <i class="ri-error-warning-line"></i>
            Invalid email format
          </small>
        </div>

        <button type="submit" class="btn-primary" [disabled]="!emailForm.valid">
          <span>Search</span>
          <i class="ri-arrow-right-line"></i>
        </button>
      </form>

      <div class="step-footer">
        <p>Remember your password? 
          <a routerLink="/login" class="link">Back to Login</a>
        </p>
      </div>
    </div>

    <!-- Step 2: Security Question -->
    <div *ngIf="currentStep === 2" class="form-step fade-in">
      <div class="step-header">
        <i class="ri-shield-check-line"></i>
        <h3>Verify Identity</h3>
        <p>Answer your security question</p>
      </div>

      <div class="security-section">
        <div class="question-box">
          <i class="ri-question-line"></i>
          <p class="question-text">{{securityQuestion}}</p>
        </div>
      </div>

      <form [formGroup]="securityForm" (ngSubmit)="onSecurityAnswerSubmit()" class="auth-form">
        <div class="form-group">
          <label for="answer">
            <i class="ri-chat-1-line"></i>
            Your Answer
          </label>
          <input 
            type="text" 
            id="answer"
            formControlName="securityAnswer" 
            class="form-control"
            placeholder="Enter your answer"
          >
          <small *ngIf="securityForm.get('securityAnswer')?.hasError('required') && securityForm.get('securityAnswer')?.touched" class="error-message">
            <i class="ri-error-warning-line"></i>
            Answer is required
          </small>
        </div>

        <button type="submit" class="btn-primary" [disabled]="!securityForm.valid">
          <span>Verify</span>
          <i class="ri-arrow-right-line"></i>
        </button>
      </form>

      <div class="step-footer">
        <button type="button" (click)="currentStep = 1" class="link-btn">
          <i class="ri-arrow-left-line"></i>
          Go Back
        </button>
      </div>
    </div>

    <!-- Step 3: Reset Password -->
    <div *ngIf="currentStep === 3" class="form-step fade-in">
      <div class="step-header">
        <i class="ri-lock-password-line"></i>
        <h3>Create New Password</h3>
        <p>Enter a strong password</p>
      </div>

      <form [formGroup]="resetForm" (ngSubmit)="onResetPassword()" class="auth-form">
        <div class="form-group">
          <label for="newPassword">
            <i class="ri-lock-line"></i>
            New Password
          </label>
          <input 
            type="password" 
            id="newPassword"
            formControlName="newPassword" 
            class="form-control"
            placeholder="Min 6 characters"
          >
          <small *ngIf="resetForm.get('newPassword')?.hasError('required') && resetForm.get('newPassword')?.touched" class="error-message">
            <i class="ri-error-warning-line"></i>
            Password is required
          </small>
          <small *ngIf="resetForm.get('newPassword')?.hasError('minlength') && resetForm.get('newPassword')?.touched" class="error-message">
            <i class="ri-error-warning-line"></i>
            Min 6 characters required
          </small>
        </div>

        <div class="form-group">
          <label for="confirmPassword">
            <i class="ri-lock-check-line"></i>
            Confirm Password
          </label>
          <input 
            type="password" 
            id="confirmPassword"
            formControlName="confirmPassword" 
            class="form-control"
            placeholder="Re-enter password"
          >
          <small *ngIf="resetForm.get('confirmPassword')?.hasError('required') && resetForm.get('confirmPassword')?.touched" class="error-message">
            <i class="ri-error-warning-line"></i>
            Please confirm your password
          </small>
          <small *ngIf="resetForm.hasError('mismatch') && resetForm.get('confirmPassword')?.touched" class="error-message">
            <i class="ri-error-warning-line"></i>
            Passwords do not match
          </small>
        </div>

        <button type="submit" class="btn-primary" [disabled]="!resetForm.valid">
          <span>Reset Password</span>
          <i class="ri-arrow-right-line"></i>
        </button>
      </form>

      <div class="step-footer">
        <button type="button" (click)="currentStep = 2" class="link-btn">
          <i class="ri-arrow-left-line"></i>
          Go Back
        </button>
      </div>
    </div>

    <!-- Step 4: Success -->
    <div *ngIf="currentStep === 4" class="form-step fade-in success-step">
      <div class="success-icon">
        <i class="ri-check-double-line"></i>
      </div>
      
      <h3>Password Reset!</h3>
      <p>Your password has been reset successfully.</p>

      <div class="success-checkmarks">
        <div class="checkmark-item">
          <i class="ri-check-circle-line"></i>
          <span>Email verified</span>
        </div>
        <div class="checkmark-item">
          <i class="ri-check-circle-line"></i>
          <span>Identity confirmed</span>
        </div>
        <div class="checkmark-item">
          <i class="ri-check-circle-line"></i>
          <span>Password updated</span>
        </div>
      </div>

      <button routerLink="/login" class="btn-primary">
        <span>Go to Login</span>
        <i class="ri-login-circle-line"></i>
      </button>
    </div>
  </div>
</div>